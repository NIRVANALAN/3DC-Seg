Dataset parameters ['self', 'num_classes', 'transform'] are missing in the config file.
Dataset parameters ['self', 'num_classes', 'transform'] are missing in the config file.
Using model: <class 'network.FUnet.FusionUNet'>
initialize network with normal
> /mnt/lustre/yslan/Repo/Segmentation/3DC-Seg/utils/Saver.py(21)load_weightsV3()
-> if wts_file is None:
(Pdb) > /mnt/lustre/yslan/Repo/Segmentation/3DC-Seg/utils/Saver.py(37)load_weightsV3()
-> checkpoint = torch.load(wts_file)
(Pdb) 'saved_models/deepblender_gan/model_best_train.pth'
(Pdb) > /mnt/lustre/yslan/Repo/Segmentation/3DC-Seg/utils/Saver.py(38)load_weightsV3()
-> start_epoch = checkpoint['epoch'] + 1 if 'epoch' in checkpoint else 0
(Pdb) dict_keys(['epoch', 'net_G', 'net_D', 'optim_G', 'optim_D', 'iter'])
(Pdb) > /mnt/lustre/yslan/Repo/Segmentation/3DC-Seg/utils/Saver.py(39)load_weightsV3()
-> start_iter = checkpoint['iter'] + 1 if 'iter' in checkpoint else 0
(Pdb) > /mnt/lustre/yslan/Repo/Segmentation/3DC-Seg/utils/Saver.py(40)load_weightsV3()
-> load_name = wts_file
(Pdb) > /mnt/lustre/yslan/Repo/Segmentation/3DC-Seg/utils/Saver.py(42)load_weightsV3()
-> if checkpoint is not None:
(Pdb) > /mnt/lustre/yslan/Repo/Segmentation/3DC-Seg/utils/Saver.py(57)load_weightsV3()
-> net_G.load_state_dict(checkpoint['net_G'])
(Pdb) > /mnt/lustre/yslan/Repo/Segmentation/3DC-Seg/utils/Saver.py(58)load_weightsV3()
-> net_D.load_state_dict(checkpoint['net_D'])
(Pdb) > /mnt/lustre/yslan/Repo/Segmentation/3DC-Seg/utils/Saver.py(59)load_weightsV3()
-> optim_G.load_state_dict(checkpoint['optim_G'])
(Pdb) > /mnt/lustre/yslan/Repo/Segmentation/3DC-Seg/utils/Saver.py(60)load_weightsV3()
-> optim_D.load_state_dict(checkpoint['optim_D'])
(Pdb) > /mnt/lustre/yslan/Repo/Segmentation/3DC-Seg/utils/Saver.py(62)load_weightsV3()
-> del checkpoint
(Pdb) > /mnt/lustre/yslan/Repo/Segmentation/3DC-Seg/utils/Saver.py(63)load_weightsV3()
-> torch.cuda.empty_cache()
(Pdb) > /mnt/lustre/yslan/Repo/Segmentation/3DC-Seg/utils/Saver.py(64)load_weightsV3()
-> print('Loaded weights from {}'.format(load_name))
(Pdb) Loaded weights from saved_models/deepblender_gan/model_best_train.pth
> /mnt/lustre/yslan/Repo/Segmentation/3DC-Seg/utils/Saver.py(66)load_weightsV3()
-> return net_G, net_D, optim_G, optim_D, start_epoch, start_iter
(Pdb) ----------------------------------------------------------------
        Layer (type)               Output Shape         Param #
================================================================
            Conv2d-1          [1, 64, 512, 512]           1,792
         LeakyReLU-2          [1, 64, 512, 512]               0
         LeakyReLU-3          [1, 64, 512, 512]               0
            Conv2d-4          [1, 64, 512, 512]          36,928
         LeakyReLU-5          [1, 64, 512, 512]               0
         LeakyReLU-6          [1, 64, 512, 512]               0
            Conv2d-7          [1, 64, 512, 512]           1,792
         LeakyReLU-8          [1, 64, 512, 512]               0
         LeakyReLU-9          [1, 64, 512, 512]               0
           Conv2d-10          [1, 64, 512, 512]          36,928
        LeakyReLU-11          [1, 64, 512, 512]               0
        LeakyReLU-12          [1, 64, 512, 512]               0
        MaxPool2d-13          [1, 64, 256, 256]               0
        MaxPool2d-14          [1, 64, 256, 256]               0
           Conv2d-15         [1, 128, 256, 256]          73,856
        LeakyReLU-16         [1, 128, 256, 256]               0
        LeakyReLU-17         [1, 128, 256, 256]               0
           Conv2d-18         [1, 128, 256, 256]         147,584
        LeakyReLU-19         [1, 128, 256, 256]               0
        LeakyReLU-20         [1, 128, 256, 256]               0
           Conv2d-21         [1, 128, 256, 256]          73,856
        LeakyReLU-22         [1, 128, 256, 256]               0
        LeakyReLU-23         [1, 128, 256, 256]               0
           Conv2d-24         [1, 128, 256, 256]         147,584
        LeakyReLU-25         [1, 128, 256, 256]               0
        LeakyReLU-26         [1, 128, 256, 256]               0
        MaxPool2d-27         [1, 128, 128, 128]               0
        MaxPool2d-28         [1, 128, 128, 128]               0
           Conv2d-29         [1, 256, 128, 128]         295,168
        LeakyReLU-30         [1, 256, 128, 128]               0
        LeakyReLU-31         [1, 256, 128, 128]               0
           Conv2d-32         [1, 256, 128, 128]         590,080
        LeakyReLU-33         [1, 256, 128, 128]               0
        LeakyReLU-34         [1, 256, 128, 128]               0
           Conv2d-35         [1, 256, 128, 128]         295,168
        LeakyReLU-36         [1, 256, 128, 128]               0
        LeakyReLU-37         [1, 256, 128, 128]               0
           Conv2d-38         [1, 256, 128, 128]         590,080
        LeakyReLU-39         [1, 256, 128, 128]               0
        LeakyReLU-40         [1, 256, 128, 128]               0
        MaxPool2d-41           [1, 256, 64, 64]               0
        MaxPool2d-42           [1, 256, 64, 64]               0
           Conv2d-43           [1, 512, 64, 64]       1,180,160
        LeakyReLU-44           [1, 512, 64, 64]               0
        LeakyReLU-45           [1, 512, 64, 64]               0
           Conv2d-46           [1, 512, 64, 64]       2,359,808
        LeakyReLU-47           [1, 512, 64, 64]               0
        LeakyReLU-48           [1, 512, 64, 64]               0
           Conv2d-49           [1, 512, 64, 64]       1,180,160
        LeakyReLU-50           [1, 512, 64, 64]               0
        LeakyReLU-51           [1, 512, 64, 64]               0
           Conv2d-52           [1, 512, 64, 64]       2,359,808
        LeakyReLU-53           [1, 512, 64, 64]               0
        LeakyReLU-54           [1, 512, 64, 64]               0
        MaxPool2d-55           [1, 512, 32, 32]               0
        MaxPool2d-56           [1, 512, 32, 32]               0
           Conv2d-57           [1, 512, 32, 32]       2,359,808
        LeakyReLU-58           [1, 512, 32, 32]               0
        LeakyReLU-59           [1, 512, 32, 32]               0
           Conv2d-60           [1, 512, 32, 32]       2,359,808
        LeakyReLU-61           [1, 512, 32, 32]               0
        LeakyReLU-62           [1, 512, 32, 32]               0
           Conv2d-63           [1, 512, 32, 32]       2,359,808
        LeakyReLU-64           [1, 512, 32, 32]               0
        LeakyReLU-65           [1, 512, 32, 32]               0
           Conv2d-66           [1, 512, 32, 32]       2,359,808
        LeakyReLU-67           [1, 512, 32, 32]               0
        LeakyReLU-68           [1, 512, 32, 32]               0
        MaxPool2d-69           [1, 512, 16, 16]               0
        MaxPool2d-70           [1, 512, 16, 16]               0
           Conv2d-71           [1, 512, 16, 16]       4,719,104
        LeakyReLU-72           [1, 512, 16, 16]               0
        LeakyReLU-73           [1, 512, 16, 16]               0
  ConvTranspose2d-74           [1, 256, 32, 32]       2,097,408
   InstanceNorm2d-75           [1, 256, 32, 32]               0
        LeakyReLU-76           [1, 256, 32, 32]               0
        LeakyReLU-77           [1, 256, 32, 32]               0
        UNetBlock-78          [1, 1280, 32, 32]               0
           Conv2d-79           [1, 512, 32, 32]       5,898,752
        LeakyReLU-80           [1, 512, 32, 32]               0
        LeakyReLU-81           [1, 512, 32, 32]               0
  ConvTranspose2d-82           [1, 256, 64, 64]       2,097,408
   InstanceNorm2d-83           [1, 256, 64, 64]               0
        LeakyReLU-84           [1, 256, 64, 64]               0
        LeakyReLU-85           [1, 256, 64, 64]               0
        UNetBlock-86          [1, 1280, 64, 64]               0
           Conv2d-87           [1, 512, 64, 64]       5,898,752
        LeakyReLU-88           [1, 512, 64, 64]               0
        LeakyReLU-89           [1, 512, 64, 64]               0
  ConvTranspose2d-90         [1, 256, 128, 128]       2,097,408
   InstanceNorm2d-91         [1, 256, 128, 128]               0
        LeakyReLU-92         [1, 256, 128, 128]               0
        LeakyReLU-93         [1, 256, 128, 128]               0
        UNetBlock-94         [1, 768, 128, 128]               0
           Conv2d-95         [1, 256, 128, 128]       1,769,728
        LeakyReLU-96         [1, 256, 128, 128]               0
        LeakyReLU-97         [1, 256, 128, 128]               0
  ConvTranspose2d-98         [1, 128, 256, 256]         524,416
   InstanceNorm2d-99         [1, 128, 256, 256]               0
       LeakyReLU-100         [1, 128, 256, 256]               0
       LeakyReLU-101         [1, 128, 256, 256]               0
       UNetBlock-102         [1, 384, 256, 256]               0
          Conv2d-103          [1, 64, 256, 256]         221,248
       LeakyReLU-104          [1, 64, 256, 256]               0
       LeakyReLU-105          [1, 64, 256, 256]               0
 ConvTranspose2d-106          [1, 32, 512, 512]          32,800
  InstanceNorm2d-107          [1, 32, 512, 512]               0
       LeakyReLU-108          [1, 32, 512, 512]               0
       LeakyReLU-109          [1, 32, 512, 512]               0
       UNetBlock-110         [1, 160, 512, 512]               0
          Conv2d-111          [1, 32, 512, 512]          46,112
       LeakyReLU-112          [1, 32, 512, 512]               0
          Conv2d-113           [1, 3, 512, 512]             867
================================================================
Total params: 44,213,987
Trainable params: 44,213,987
Non-trainable params: 0
----------------------------------------------------------------
Input size (MB): 2359296.00
Forward/backward pass size (MB): 4777.00
Params size (MB): 168.66
Estimated Total Size (MB): 2364241.66
----------------------------------------------------------------
None
Arguments used: CUDNN_BENCHMARK: False
DATALOADER:
  ASPECT_RATIO_GROUPING: True
  FILTER_EMPTY_ANNOTATIONS: True
  NUM_SAMPLES: -1
  NUM_WORKERS: 16
  REPEAT_THRESHOLD: 0.0
  SAMPLER_TRAIN: TrainingSampler
DATASETS:
  IMSET: 2016/val.txt
  MAX_TEMPORAL_GAP: 12
  PRECOMPUTED_PROPOSAL_TOPK_TRAIN: 2000
  PROPOSAL_FILES_TRAIN: ()
  RANDOM_INSTANCE: False
  TEST: Davis
  TEST_ROOT: /mnt/lustre/yslan/Dataset/davis-2017/DAVIS
  TRAIN: Davis
  TRAIN_ROOT: /mnt/lustre/yslan/Dataset/davis-2017/DAVIS
GLOBAL:
  HACK: 1.0
INFERENCE:
  CLIP_OVERLAP: 3
  ENGINE: SaliencyInferenceEngine
  EXHAUSTIVE: False
  SAVE_LOGITS: False
INPUT:
  FORMAT: RGB
  MASK_FORMAT: polygon
  RESIZE_MODE_TEST: resize_short_edge
  RESIZE_MODE_TRAIN: resize_short_edge_and_crop
  RESIZE_SHAPE_TEST: (480,)
  RESIZE_SHAPE_TRAIN: (480, 854)
  TW: 1
MODEL:
  BACKBONE:
    DEEPBLENDER: True
    FREEZE_AT: 2
    FREEZE_BN: True
    INPUT_C: 3
    NAME: FusionUNet
    OUTPUT_C: 3
    PRETRAINED_WTS: 
    UP_CONV1_INPLANES: [384, 768, 1280, 1280, 1024]
    UP_CONV1_OUTPLANES: [64, 256, 512, 512, 512]
  DECODER:
    INTER_BLOCK: GC3d
    REFINE_BLOCK: Refine3d
  FREEZE_BN: True
  MASK_ON: False
  NETWORK: FusionUNet
  N_CLASSES: 2
  PIXEL_MEAN: [114.7748, 107.7354, 99.475]
  PIXEL_STD: [1.0, 1.0, 1.0]
  PRETRAINED: False
  WEIGHTS: 
NAME: deepblender_gan
OUTPUT_DIR: ./output
SEED: -1
SOLVER:
  BASE_LR: 0.001
  BIAS_LR_FACTOR: 1.0
  CHECKPOINT_PERIOD: 5000
  CLIP_GRADIENTS:
    CLIP_TYPE: value
    CLIP_VALUE: 1.0
    ENABLED: False
    NORM_TYPE: 2.0
  GAMMA: 0.1
  IMS_PER_BATCH: 16
  LR_SCHEDULERS: ['exponential', 'step']
  MAX_ITER: 40000
  MOMENTUM: 0.9
  NESTEROV: False
  STEPS: [10]
  WARMUP_FACTOR: 0.001
  WARMUP_ITERS: 1000
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0.0001
  WEIGHT_DECAY_NORM: 0.0
TRAINING:
  BASE_LR: 5e-05
  BATCH_SIZE: 8
  EVAL_EPOCH: 1
  LOSSES:
    BOOTSTRAP: False
    CRITERION: 
    MASK_CONSISTENCY: False
    MULTI_CLASS: False
    NAME: ['l1', 'gan']
    SCALE: []
    USE_IGNORE_MASK: False
  LR_SCHEDULERS: ['exponential', 'step']
  MAX_ITER: 90000
  NUM_EPOCHS: 100
  OPTIMISER: Adam
  PRECISION: mixed
  STEPS: (60000, 80000)
VERSION: 2
VIS_PERIOD: 0
[Iter: 9488]Epoch: [0][0/4216]	Time 20.595 (20.595)	Data Time 9.516 (9.516)	LOSSES - loss_D:0.000001(0.000001) loss_G_GAN:0.006943(0.006943) loss_G_L1:0.045541(0.045541) total_loss:0.052485(0.052485))	
[Iter: 9489]Epoch: [0][8/4216]	Time 1.516 (11.055)	Data Time 0.105 (4.810)	LOSSES - loss_D:0.000000(0.000001) loss_G_GAN:0.009737(0.008340) loss_G_L1:0.046148(0.045844) total_loss:0.055885(0.054185))	
[Iter: 9490]Epoch: [0][16/4216]	Time 1.488 (7.866)	Data Time 0.076 (3.232)	LOSSES - loss_D:0.000000(0.000001) loss_G_GAN:0.009661(0.008780) loss_G_L1:0.050421(0.047370) total_loss:0.060082(0.056151))	
[Iter: 9491]Epoch: [0][24/4216]	Time 1.494 (6.273)	Data Time 0.084 (2.445)	LOSSES - loss_D:0.000001(0.000001) loss_G_GAN:0.009667(0.009002) loss_G_L1:0.053635(0.048936) total_loss:0.063303(0.057939))	
[Iter: 9492]Epoch: [0][32/4216]	Time 1.499 (5.318)	Data Time 0.089 (1.974)	LOSSES - loss_D:0.000000(0.000001) loss_G_GAN:0.010081(0.009218) loss_G_L1:0.051225(0.049394) total_loss:0.061307(0.058612))	
[Iter: 9493]Epoch: [0][40/4216]	Time 1.511 (4.684)	Data Time 0.096 (1.661)	LOSSES - loss_D:0.000001(0.000001) loss_G_GAN:0.008662(0.009125) loss_G_L1:0.050591(0.049594) total_loss:0.059255(0.058719))	
[Iter: 9494]Epoch: [0][48/4216]	Time 1.492 (4.228)	Data Time 0.083 (1.436)	LOSSES - loss_D:0.000001(0.000001) loss_G_GAN:0.008598(0.009050) loss_G_L1:0.042201(0.048537) total_loss:0.050799(0.057588))	
[Iter: 9495]Epoch: [0][56/4216]	Time 1.496 (3.886)	Data Time 0.084 (1.267)	LOSSES - loss_D:0.000000(0.000001) loss_G_GAN:0.009100(0.009056) loss_G_L1:0.055795(0.049445) total_loss:0.064896(0.058501))	
[Iter: 9496]Epoch: [0][64/4216]	Time 1.493 (3.620)	Data Time 0.082 (1.135)	LOSSES - loss_D:0.000000(0.000001) loss_G_GAN:0.009494(0.009105) loss_G_L1:0.037604(0.048129) total_loss:0.047098(0.057234))	
[Iter: 9497]Epoch: [0][72/4216]	Time 1.486 (3.407)	Data Time 0.074 (1.029)	LOSSES - loss_D:0.000001(0.000001) loss_G_GAN:0.009298(0.009124) loss_G_L1:0.046732(0.047989) total_loss:0.056031(0.057114))	
